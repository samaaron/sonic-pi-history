define :foobar do
  with_fx :bitcrusher, bits: rrand_i(2, 16), sample_rate: rrand(1000, 10000) do
    with_fx :none, mix: 0.125 do
#      sample :drum_heavy_kick, amp: 2
#      sample :elec_blip2
      use_synth :tb303
      play chord(:e1, :minor).choose, attack: 0, release: 1
      sleep 1
    end
  end
end

in_thread(name: :sam) do
  loop do
    foobar
  end
end